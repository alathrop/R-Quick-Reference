---
title:  "Package Management Quick Reference"
author: "Andy Lathrop"
date:   "March 23, 2016"
output: 
  html_document:
    theme: united
    toc: TRUE
    toc_float: TRUE
    code_folding: show
---

#### Built with Microsoft R Open version `r getRversion()`. More info at https://mran.revolutionanalytics.com/open/
#### The current CRAN repository for local packages is `r getOption("repos")`
#### The current MRAN repository is https://mran.revolutionanalytics.com/timemachine/

Setup options: echo means R code will be displayed | cache means results will be stored for future knits
```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
```

# Admin notes
This is an R markdown document and requires the 'rmarkdown' package
```{r}
install.packages('rmarkdown', repos='http://cran.us.r-project.org')
library(rmarkdown)
```

# Package management utilities
The list of CRAN mirrors can be found at https://cran.r-project.org/mirrors.html

## Repo used by current R session
```{r}
getOption("repos")
```

## Current local library
```{r}
normalizePath(.libPaths(), winslash = "/")
```

## Local library of packages
```{r}
installed.packages()[, "Package"]
```

## Choose CRAN mirror site from list 
#### (remove # to run code)
```{r}
# chooseCRANmirror()
```

## Choose a CRAN repo via URL
```{r}
options(repos=structure(c(CRAN="http://cran.us.r-project.org")))
```

## Install from a particular mirror
```{r}
install.packages('rmarkdown', repos='http://cran.us.r-project.org')
```

## Permanently set CRAN repo
#### (does not work with Microsoft R distro)
```{r}
local({
  r <- getOption("repos")
  r["CRAN"] <- "http://cran.us.r-project.org"
  options(repos = r)
})
```

## Add CRAN repos 
#### (remove # to run code)
```{r}
# setRepositories(addURLs =
#                   c(CRANxtras = "http://cran.us.r-project.org"))
# setRepositories(addURLs =
#                   c(CRAN = "http://cran.us.r-project.org"))
```

## Packages w/ newer versions available
```{r}
old.packages()
```

# About using Microsoft R distribution
#### Microsoft uses the MRAN repo for packages, usually a snapshot of the Austria CRAN repo from the first of the month
**(more info at https://mran.revolutionanalytics.com/timemachine/ )**

The 'checkpoint' package from MSFT is helpful for using a specific repo snapshot
more info at http://bit.ly/1Rzrqdy  

* When you create a checkpoint, the checkpoint() function performs the following:
    + Creates a snapshot folder to install packages. This library folder is located at ~/.checkpoint
    + Scans your project folder for all packages used. Specifically, it searches for all instances of library() and requires() in your code.
    + Installs these packages from the MRAN snapshot into your snapshot folder using install.packages()
    + Sets options for your CRAN mirror to point to a MRAN snapshot, i.e. modify options(repos)
    
This means the remainder of your script will run with the packages from a specific date.

![Caption](myGraphics\\MSFT-R-Checkpoint.png)
